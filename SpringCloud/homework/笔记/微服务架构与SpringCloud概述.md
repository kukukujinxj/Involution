------



# 微服务架构与SpringCloud概述

## 1 微服务架构

### 1.1 微服务架构体现的思想及优缺点

- 微服务架构设计的核⼼思想就是“微”，拆分的粒度相对⽐较⼩，这样的话单⼀职责、开发的耦合度就会降低、微⼩的功能可以独⽴部署扩展、灵活性强，升级改造影响范围⼩

- 微服务架构可以说是SOA架构的⼀种拓展，这种架构模式下它拆分粒度更⼩、服务更独⽴。把应⽤拆分成为⼀个个微⼩的服务，不同的服务可以使⽤不同的开发语⾔和存储，服务之间往往通过Restful等轻量级通信。微服务架构关键在于微⼩、独⽴、轻量级通信

- 微服务架构的缺点

    - 微服务架构下，分布式复杂难以管理，当服务数量增加，管理将越加复杂
    
    - 微服务架构下，分布式链路跟踪难等

### 1.2 微服务架构中的⼀些概念

- 服务注册：服务提供者将所提供服务的信息（服务器IP和端⼝、服务访问协议等）注册/登记到注册中⼼

- 服务发现：服务消费者能够从注册中⼼获取到较为实时的服务列表，然后根究⼀定的策略选择⼀个服务访问

- 负载均衡：将请求压⼒分配到多个服务器（应⽤服务器、数据库服务器等），以此来提⾼服务的性能、可靠性

- 熔断：断路保护。微服务架构中，如果下游服务因访问压⼒过⼤⽽响应变慢或失败，上游服务为了保护系统整体可⽤性，可以暂时切断对下游服务的调⽤。这种牺牲局部，保全整体的措施就叫做熔断

- 链路追踪：对⼀次请求涉及的很多个服务链路进⾏⽇志记录、性能监控

- API⽹关：

    - 统⼀接⼊（路由）
    
    - 安全防护（统⼀鉴权，负责⽹关访问身份认证验证，与“访问认证中⼼”通信，实 际认证业务逻辑交移“访问认证中⼼”处理）
    
    - ⿊⽩名单（实现通过IP地址控制禁⽌访问⽹关功能，控制访问）
    
    - 协议适配（实现通信协议校验、适配转换的功能）
    
    - 流量管控（限流）
    
    - ⻓短链接⽀持
    
    - 容错能⼒（负载均衡）

## 2 Spring Cloud综述

### 2.1 Spring Cloud 是什么

- Spring Cloud是⼀系列框架的有序集合（Spring Cloud是⼀个规范）

- 开发服务发现注册、配置中⼼、消息总线、负载均衡、断路器、数据监控等

- 利⽤Spring Boot的开发便利性简化了微服务架构的开发（⾃动装配）

### 2.2 Spring Cloud 核⼼组件

- | | 第⼀代 Spring Cloud（Netflix，SCN） | 第⼆代 Spring Cloud（Spring Cloud Alibaba，SCA） |
  | :-----| :---- | :---- |
  | 注册中⼼ | Netflix Eureka | 阿⾥巴巴 Nacos |
  | 客户端负载均衡 | Netflix Ribbon | 阿⾥巴巴 Dubbo LB、Spring Cloud Loadbalancer |
  | 熔断器 | Netflix Hystrix | 阿⾥巴巴 Sentinel |
  | ⽹关 | Netflix Zuul：性能⼀般，未来将退出Spring Cloud ⽣态圈 | 官⽅ Spring Cloud Gateway |
  | 配置中⼼ | 官⽅ Spring Cloud Config | 阿⾥巴巴 Nacos、携程 Apollo |
  | 服务调⽤ | Netflix Feign | 阿⾥巴巴 Dubbo RPC |
  | 消息驱动 | 官⽅ Spring Cloud Stream | |
  | 链路追踪 | 官⽅ Spring Cloud Sleuth/Zipkin | |
  | 分布式事务 | | 阿⾥巴巴 seata 分布式事务⽅案 |

### 2.3 Spring Cloud 与 Dubbo 对⽐

- Dubbo是阿⾥巴巴公司开源的⼀个⾼性能优秀的服务框架，基于RPC调⽤，对于⽬前使⽤率较⾼的Spring Cloud Netflix来说，它是基于HTTP的，所以效率上没有Dubbo⾼，但问题在于Dubbo体系的组件不全，不能够提供⼀站式解决⽅案

### 2.4 Spring Cloud 与 Spring Boot 的关系

- Spring Cloud 只是利⽤了Spring Boot 的特点，让我们能够快速的实现微服务组件开发